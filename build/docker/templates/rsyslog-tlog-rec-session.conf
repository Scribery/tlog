template(name="tlog" type="list") {
    constant(value="{")
    property(name="timegenerated"
    outname="timestamp"
    format="jsonf"
    dateFormat="rfc3339")
    constant(value=",")
    property(name="msg"
    regex.expression="{\\(.*\\)"
    regex.submatch="1")
    constant(value="\n")
}

if $programname == "tlog" then {
    action(name="tlog-file"
       type="omfile"
       file="/var/log/tlog.log"
       fileCreateMode="0600"
       template="tlog")
}